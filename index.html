<!DOCTYPE html>
<html>
<head>
    <title>Chat App</title>
    <style>
        /* Add some basic styling */
        #messages {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }
        #messages li {
            padding: 8px;
            margin-bottom: 10px;
            background-color: #f4f4f4;
            border: 1px solid #ddd;
        }
        #messageForm {
            display: flex;
            margin-top: 10px;
        }
        #messageForm input {
            flex: 1;
            padding: 10px;
            font-size: 16px;
        }
        #messageForm button {
            padding: 10px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="usernameForm">
        <label for="usernameInput">Enter your username:</label>
        <input id="usernameInput" type="text" />
        <button id="usernameSubmit">Submit</button>
    </div>
    <ul id="messages"></ul>
    <form id="messageForm" action="">
        <input id="messageInput" autocomplete="off" /><button>Send</button>
    </form>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        var username = '';

        // Function to set the username and start the chat
        function setUsername() {
            var usernameInput = document.getElementById('usernameInput');
            var usernameSubmit = document.getElementById('usernameSubmit');
            var usernameForm = document.getElementById('usernameForm');
            var messageForm = document.getElementById('messageForm');

            usernameSubmit.addEventListener('click', function(e) {
                e.preventDefault();
                username = usernameInput.value.trim();
                if (username) {
                    usernameForm.style.display = 'none';
                    messageForm.style.display = 'block';
                    startChat();
                }
            });
        }

        // Function to start the chat after username is set
        function startChat() {
            var form = document.getElementById('messageForm');
            var input = document.getElementById('messageInput');
            var messages = document.getElementById('messages');

            <!DOCTYPE html>
            <html>
            <head>
                <title>Chat App</title>
                <style>
                    /* Add some basic styling */
                    #messages {
                        list-style-type: none;
                        margin: 0;
                        padding: 0;
                    }
                    #messages li {
                        padding: 8px;
                        margin-bottom: 10px;
                        background-color: #f4f4f4;
                        border: 1px solid #ddd;
                    }
                    #messageForm {
                        display: none; /* Hide message form initially */
                        margin-top: 10px;
                    }
                    #messageForm input {
                        flex: 1;
                        padding: 10px;
                        font-size: 16px;
                    }
                    #messageForm button {
                        padding: 10px;
                        font-size: 16px;
                        background-color: #4CAF50;
                        color: white;
                        border: none;
                        cursor: pointer;
                    }
                </style>
            </head>
            <body>
                <div id="usernameForm">
                    <label for="usernameInput">Enter your username:</label>
                    <input id="usernameInput" type="text" />
                    <button id="usernameSubmit">Submit</button>
                </div>
                <ul id="messages"></ul>
                <form id="messageForm" action="">
                    <input id="messageInput" autocomplete="off" /><button>Send</button>
                </form>
                <script src="/socket.io/socket.io.js"></script>
                <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                <script>
                    $(document).ready(function() {
                        var socket = io();

                        $('#usernameForm').submit(function(e) {
                            e.preventDefault();
                            var username = $('#usernameInput').val().trim();
                            if (username) {
                                socket.emit('set username', username);
                                $('#usernameForm').hide();
                                $('#messageForm').show();
                            }
                        });

                        $('#messageForm').submit(function(e) {
                            e.preventDefault();
                            var message = $('#messageInput').val().trim();
                            if (message) {
                                socket.emit('chat message', message);
                                $('#messageInput').val('');
                            }
                        });

                        socket.on('chat message', function(msg) {
                            $('#messages').append($('<li>').text(msg));
                            window.scrollTo(0, document.body.scrollHeight);
                        });
                    });
                </script>
            </body>
            </html>
